<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>task&#x81ea;&#x52a8;&#x8ba1;&#x7b97;&#x7a0b;&#x5e8f;&#x4f7f;&#x7528;&#x8bf4;&#x660e;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <h1 id="task自动计算程序使用说明">task自动计算程序使用说明</h1>
<h2 id="1-内容">1. 内容</h2>
<ul>
<li>task_module.py</li>
<li>geom_extract.py</li>
<li>smiles_parser.py</li>
</ul>
<h3 id="11-task_modulepy">1.1 task_module.py</h3>
<p>该脚本存放在<em>script_path2</em>，为driver脚本，负责解析任务块、调度其他脚本完成任务。</p>
<pre><code class="language-python"><span class="hljs-comment"># 定义脚本目录</span>
script_path1 = os.path.expanduser(<span class="hljs-string">&#x27;~/apprepo/gaussian/16-hy/scripts/python&#x27;</span>)
script_path2 = os.path.expanduser(<span class="hljs-string">&#x27;~/apprepo/gaussian/16-hy/scripts/tasks&#x27;</span>)
<span class="hljs-comment"># 定义日志目录</span>
~/AutoCalc/tasks/task_processing.log
<span class="hljs-comment"># 任务文件夹</span>
TASKS_DIR = os.path.expanduser(<span class="hljs-string">&quot;~/AutoCalc/tasks&quot;</span>)
</code></pre>
<p>task_module.py运行后，会对TASKS_DIR下的每个子文件夹的内容进行检查，若匹配到文件名相同的两个后缀名分别为.com与.task的文件，则按照task文件中的内容进行处理，生成Gaussian输入文件。该脚本运行时无需交互输入，适合放在<em>crontab</em>中定时运行</p>
<h3 id="12-geom_extractpy">1.2 geom_extract.py</h3>
<p>该脚本存放在<em>script_path1</em>目录，可以解析几何信息。支持提取Gaussian 16的输入与输出文件中的几何信息，但只会保留坐标信息，冻结信息等会丢失。</p>
<p>对于gjf文件，支持Chem3D导出的格式或GView导出的标准格式。</p>
<p>对于log文件，支持Standard orientation下的标准朝向坐标。对于使用了nosymm的情况，也支持Input orientation。</p>
<h3 id="13-smiles_parserpy">1.3 smiles_parser.py</h3>
<p>该脚本存放在<em>script_path2</em>，依赖<em>rdkit</em>库和<em>requests</em>库。只有在几何信息以smiles字符串或CAS号的形式提供时才会启用，将其转换为3D结构，并使用MMFF94力场进行预优化，上限1000步。若MMFF94对当前体系不可用，则改用UFF力场。</p>
<p>若以CAS提供，则需连接外部网络，从pubChem提供的API接口转换为smiles结构</p>
<h3 id="14-slurmssh">(1.4 <a href="http://slurms.sh">slurms.sh</a>)</h3>
<p>该脚本运行后会自定义文件夹下的尚未提交的gjf文件，可以作为task_module.py的上级脚本使用。</p>
<h2 id="2-task文件语法">2. task文件语法</h2>
<p>该文件可以定义多个以$开头的任务块，程序会依次进行处理:</p>
<pre><code>$task_name
%opt
# opt freq
</code></pre>
<h3 id="">$</h3>
<p>&quot;$&quot;作为一个任务块的开始，定义了该任务的名称。脚本处理该任务块时，会为其创建名为<em>task_name</em>的文件夹，对应输入文件均创建在该文件夹下。</p>
<h3 id="-1">%</h3>
<p>&quot;%&quot;指示了当前任务块几何信息的来源。脚本会寻找&quot;%&quot;指示的任务块文件夹，从该任务块的log文件中读取最后一帧的几何信息。暂不支持{}。预留关键词如下：</p>
<ul>
<li>%origin 表示从原始.com文件中读取几何信息</li>
<li>%smiles=CCO 表示从smiles字符串(当前示例为乙醇)转换为3D结构。也支持在此处输入CAS号，嗯，我知道这很蠢。</li>
</ul>
<h3 id="-2">#</h3>
<p>&quot;#&quot;后的内容为你想要当前任务块使用的Gaussian任务关键词。特殊语法{}表示为{}内的每一个元素创建一个将{}整体替换为该元素的输入文件。</p>
<h2 id="3-待开发功能">3. 待开发功能</h2>
<ul>
<li>%支持指定目录文件</li>
<li>支持xyz格式文件</li>
<li>支持在当前任务结束后自动执行某些脚本，如fchk</li>
<li>支持判断震荡情况</li>
<li>与mail模块结合实时监控任务状况</li>
</ul>

            <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
            
        </body>
        </html>